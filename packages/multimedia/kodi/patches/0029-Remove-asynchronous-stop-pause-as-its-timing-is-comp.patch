From 5bdb78a5fb6b01d0c41a4ecf62aa237350e2a460 Mon Sep 17 00:00:00 2001
From: Matus Kral <matuskral@me.com>
Date: Mon, 5 Sep 2016 02:27:06 +0200
Subject: [PATCH 29/37] Remove asynchronous stop/pause as its timing is
 completely not where needed

---
 xbmc/cores/VideoPlayer/VideoPlayer.cpp | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/xbmc/cores/VideoPlayer/VideoPlayer.cpp b/xbmc/cores/VideoPlayer/VideoPlayer.cpp
index 39b67da..7ba01a7 100644
--- a/xbmc/cores/VideoPlayer/VideoPlayer.cpp
+++ b/xbmc/cores/VideoPlayer/VideoPlayer.cpp
@@ -5158,17 +5158,21 @@ void CVideoPlayer::UpdateClockSync(bool enabled)
 void CVideoPlayer::OnLostDisplay()
 {
   CLog::Log(LOGNOTICE, "VideoPlayer: OnLostDisplay received");
+  m_clock.Pause(true);
+#ifndef HAS_IMXVPU
   m_VideoPlayerAudio->SendMessage(new CDVDMsgBool(CDVDMsg::GENERAL_PAUSE, true), 1);
   m_VideoPlayerVideo->SendMessage(new CDVDMsgBool(CDVDMsg::GENERAL_PAUSE, true), 1);
-  m_clock.Pause(true);
+#endif
   m_displayLost = true;
 }
 
 void CVideoPlayer::OnResetDisplay()
 {
   CLog::Log(LOGNOTICE, "VideoPlayer: OnResetDisplay received");
+  m_clock.Pause(false);
+#ifndef HAS_IMXVPU
   m_VideoPlayerAudio->SendMessage(new CDVDMsgBool(CDVDMsg::GENERAL_PAUSE, false), 1);
   m_VideoPlayerVideo->SendMessage(new CDVDMsgBool(CDVDMsg::GENERAL_PAUSE, false), 1);
-  m_clock.Pause(false);
+#endif
   m_displayLost = false;
 }
-- 
1.9.1

